(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-92f3e50a"],{"1b5d":function(e,s,t){"use strict";t("2b58")},"2b58":function(e,s,t){},4852:function(e,s,t){"use strict";t.r(s);var a=function(){var e=this,s=e._self._c;return s("div",[s("h3",{staticStyle:{"letter-spacing":"1px","font-weight":"400","padding-bottom":"20px"}},[e._v(" 基本设置 ")]),s("div",[s("el-form",{ref:"form",staticStyle:{width:"350px",float:"left"},attrs:{"label-position":"top",model:e.user,"label-width":"80px"}},[s("el-form-item",{staticStyle:{padding:"0"},attrs:{label:"用户名"}},[s("el-input",{attrs:{disabled:""},model:{value:e.user.username,callback:function(s){e.$set(e.user,"username",s)},expression:"user.username"}})],1),s("el-form-item",{attrs:{label:"性别"}},[s("el-radio-group",{model:{value:e.user.gender,callback:function(s){e.$set(e.user,"gender",s)},expression:"user.gender"}},[s("el-radio",{attrs:{label:1}},[e._v("男")]),s("el-radio",{attrs:{label:0}},[e._v("女")])],1)],1),s("el-form-item",{attrs:{label:"出生年月"}},[s("el-col",[s("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd"},model:{value:e.user.birthday,callback:function(s){e.$set(e.user,"birthday",s)},expression:"user.birthday"}})],1)],1),s("el-form-item",{staticStyle:{padding:"0"},attrs:{label:"邮箱"}},[s("el-input",{attrs:{type:"email",disabled:""},model:{value:e.user.email,callback:function(s){e.$set(e.user,"email",s)},expression:"user.email"}}),2==e.user.status?s("el-link",{on:{click:e.activationEmail}},[e._v("邮箱未激活！点击激活邮箱！")]):e._e()],1),s("el-form-item",{attrs:{label:"个人简介"}},[s("el-input",{attrs:{rows:5,type:"textarea"},model:{value:e.user.info,callback:function(s){e.$set(e.user,"info",s)},expression:"user.info"}})],1),s("el-form-item",{staticStyle:{padding:"0"},attrs:{label:"上次登录时间"}},[s("el-input",{attrs:{type:"text",disabled:""},model:{value:e.user.lastLoginTime,callback:function(s){e.$set(e.user,"lastLoginTime",s)},expression:"user.lastLoginTime"}})],1),s("el-form-item",{staticStyle:{"padding-top":"20px"}},[s("el-button",{attrs:{type:"primary"},on:{click:e.updateInfo}},[e._v("更新基本信息")]),s("el-button",{attrs:{type:"primary"},on:{click:e.showResetPass}},[e._v("修改密码")]),s("el-button",{attrs:{type:"primary"},on:{click:e.showResetEmail}},[e._v("修改邮箱")])],1)],1),s("div",[s("img",{staticStyle:{"padding-bottom":"10px","padding-left":"150px",width:"150px",height:"150px"},attrs:{alt:"",src:e.user.head}}),s("el-upload",{staticClass:"upload-demo",staticStyle:{"padding-left":"500px","letter-spacing":"1px"},attrs:{accept:".png,.jpg",headers:e.header,action:e.uploadAction,"on-success":e.handleUploadSuccess,limit:1}},[s("el-button",{staticStyle:{width:"150px"},attrs:{size:"small",type:"primary"}},[s("i",{staticClass:"el-icon-upload2"}),e._v(" 点击上传 ")]),s("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传jpg/png文件")])],1)],1),s("el-dialog",{attrs:{title:"修改密码",visible:e.resetPassDialogVisible,width:"50%"},on:{"update:visible":function(s){e.resetPassDialogVisible=s},close:e.resetPassDialogClosed}},[s("el-form",{ref:"resetPassForm",attrs:{model:e.resetPassForm,rules:e.resetPassFormRules,"label-width":"100px"}},[s("el-form-item",{attrs:{label:"旧密码",prop:"oldPassword"}},[s("el-input",{staticStyle:{width:"80%"},attrs:{type:"password"},model:{value:e.resetPassForm.oldPassword,callback:function(s){e.$set(e.resetPassForm,"oldPassword",s)},expression:"resetPassForm.oldPassword"}})],1),s("el-form-item",{attrs:{label:"新密码",prop:"newPassword"}},[s("el-input",{staticStyle:{width:"80%"},attrs:{type:"password"},model:{value:e.resetPassForm.newPassword,callback:function(s){e.$set(e.resetPassForm,"newPassword",s)},expression:"resetPassForm.newPassword"}})],1),s("el-form-item",{attrs:{label:"确认密码",prop:"confirmPassword"}},[s("el-input",{staticStyle:{width:"80%"},attrs:{type:"password"},model:{value:e.resetPassForm.confirmPassword,callback:function(s){e.$set(e.resetPassForm,"confirmPassword",s)},expression:"resetPassForm.confirmPassword"}})],1)],1),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:e.resetPassDialogClosed}},[e._v("取 消")]),s("el-button",{attrs:{type:"primary"},on:{click:e.resetPass}},[e._v("确 定")])],1)],1),s("el-dialog",{attrs:{title:"修改邮箱",visible:e.resetEmailDialogVisible,width:"50%"},on:{"update:visible":function(s){e.resetEmailDialogVisible=s},close:e.resetEmailDialogClosed}},[s("el-form",{ref:"resetPassForm",attrs:{model:e.reseEmailForm,rules:e.reseEmailFormRules,"label-width":"100px"}},[s("el-form-item",{attrs:{label:"新邮箱",prop:"email"}},[s("el-input",{staticStyle:{width:"80%"},attrs:{type:"text"},model:{value:e.reseEmailForm.email,callback:function(s){e.$set(e.reseEmailForm,"email",s)},expression:"reseEmailForm.email"}})],1)],1),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:e.resetEmailDialogClosed}},[e._v("取 消")]),s("el-button",{attrs:{type:"primary"},on:{click:e.resetEmail}},[e._v("确 定")])],1)],1)],1)])},r=[],i=t("c24f"),l=t("db49"),o=t("5f87"),n=t("96c7"),d={data(){const e=(e,s,t)=>{if(""===s)t(new Error("请正确填写邮箱"));else{if(""!==s){var a=/^[A-Za-z0-9\u4e00-\u9fa5]+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$/;a.test(s)||t(new Error("请输入有效的邮箱"))}t()}};let s=(e,s,t)=>{s!==this.resetPassForm.newPassword?t(new Error("两次输入密码不一致!")):t()};return{header:{Authentication:Object(o["b"])()},uploadAction:l["a"].API_URL+"/upload/changeHead",user:{id:"",username:"",email:"",birthday:"",gender:"",info:"",head:"",lastLoginTime:"",status:""},resetPassDialogVisible:!1,resetEmailDialogVisible:!1,resetPassForm:{oldPassword:"",newPassword:"",confirmPassword:""},reseEmailForm:{email:""},resetPassFormRules:{oldPassword:[{required:!0,message:"请输入旧密码",trigger:"blur"}],newPassword:[{required:!0,message:"请输入新密码",trigger:"blur"}],confirmPassword:[{required:!0,message:"请再次输入密码",trigger:"blur"},{validator:s,trigger:"blur"}]},reseEmailFormRules:{email:[{required:!0,trigger:"blur",validator:e}]}}},mounted(){null!==Object(o["a"])()?Object(i["a"])(Object(o["a"])()).then(e=>{const{obj:s}=e;console.log(s),this.user=s}):this.$router.push({name:"login",query:{redirect:this.$router.currentRoute.fullPath}})},methods:{updateInfo(){Object(i["o"])(this.user).then(e=>{200!==e.code?this.$message.error(e.message):(this.$message.success("更新信息成功"),console.log(e.obj),this.user=e.obj)})},async showResetPass(){this.resetPassDialogVisible=!0},async showResetEmail(){this.resetEmailDialogVisible=!0},resetPassDialogClosed(){this.$refs.resetPassForm.resetFields(),this.resetPassDialogVisible=!1},resetEmailDialogClosed(){this.$refs.resetPassForm.resetFields(),this.resetEmailDialogVisible=!1},resetEmail(){this.$refs.reseEmailForm.validate(async e=>{if(!e)return 0;await Object(i["m"])(this.reseEmailForm).then(e=>{200===e.code?(this.$message.success("修改成功！"),this.email=this.reseEmailForm.email,this.resetPassDialogVisible=!1):this.$message.error(e.message)})})},resetPass(){this.$refs.resetPassForm.validate(async e=>{if(!e)return 0;await Object(i["n"])(this.resetPassForm).then(e=>{200===e.code?(this.$message.success("修改成功！"),this.resetPassDialogVisible=!1):this.$message.error(e.message)})})},activationEmail(){Object(i["l"])().then(e=>{200!==e.code?this.$message.error(e.message):this.$message.success("激活邮件已发送，请注意查收！")})},handleUploadSuccess(e){200===e.code?(this.user.head=e.obj,n["a"].methods.setHead(),this.$store.dispatch("user/setHead",e.obj),this.$message({type:"success",message:"头像上传成功!"})):this.$message({type:"error",message:e.message})}}},m=d,c=(t("1b5d"),t("2877")),u=Object(c["a"])(m,a,r,!1,null,"92db5eec",null);s["default"]=u.exports}}]);
//# sourceMappingURL=chunk-92f3e50a.0b3b920b.js.map